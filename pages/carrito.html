<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras | Velas Starlight</title>

    <!-- ========================================
         CONFIGURACIÓN DE TAILWIND CSS
         ======================================== -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configuración personalizada de Tailwind con colores de marca
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'beige-almond': '#F6F1E9',    // Color de fondo principal
                        'dark-green': '#2D3E33',      // Verde oscuro para texto y botones
                        'warm-cream': '#EDE6DA',      // Crema cálido
                        'sage-green': '#3A5A40',      // Verde salvia para hover
                        'leaf-green': '#A3B18A',      // Verde hoja
                        'gray-sand': '#D6CEC3',       // Gris arena
                    },
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],           // Fuente principal
                        serif: ['Playfair Display', 'serif'],      // Fuente para títulos
                    },
                }
            }
        }
    </script>

    <!-- ========================================
         LIBRERÍAS EXTERNAS
         ======================================== -->
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Favicon del sitio -->
    <link rel="icon" type="image/png" href="../images/favicon.png">

    <!-- Google Fonts: Poppins y Playfair Display -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- ========================================
         ESTILOS PERSONALIZADOS
         ======================================== -->
    <style>
        /* Estilos para iconos del navbar */
        .nav ul li a i {
            color: #2D3E33;
        }

        .nav ul li a:hover i {
            color: #3A5A40;
        }

        /* Animación para elementos del carrito */
        .cart-item {
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Estilos para botones de cantidad */
        .quantity-btn {
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            transform: scale(1.1);
        }
    </style>
</head>

<body class="bg-beige-almond text-dark-green font-sans">

    <!-- ========================================
         HEADER / NAVEGACIÓN
         ======================================== -->
    <header class="bg-white shadow-md fixed w-full z-50">
        <div class="container mx-auto flex justify-between items-center py-4 px-6">
            <!-- Logo de la empresa -->
            <a href="../index.html">
                <img src="../images/logo.png" alt="Velas Starlight Logo" class="h-12 w-auto">
            </a>

            <!-- Navegación para escritorio -->
            <nav class="hidden md:flex space-x-8 font-medium text-dark-green items-center">
                <a href="../index.html" class="hover:text-sage-green flex items-center transition-colors duration-300">
                    <i class="fa fa-home mr-1"></i>Inicio
                </a>
                <a href="productos.html" class="hover:text-sage-green flex items-center transition-colors duration-300">
                    <i class="fa fa-cube mr-1"></i>Productos
                </a>
                <a href="blog.html" class="hover:text-sage-green flex items-center transition-colors duration-300">
                    <i class="fa fa-blog mr-1"></i>Blog
                </a>
                <a href="contacto.html" class="hover:text-sage-green flex items-center transition-colors duration-300">
                    <i class="fa fa-phone mr-1"></i>Contacto
                </a>

                <!-- Icono del carrito con contador -->
                <a href="carrito.html" class="relative text-sage-green transition-colors duration-300">
                    <i class="fa fa-shopping-cart text-xl"></i>
                    <span id="cart-count"
                        class="absolute -top-3 -right-3 bg-sage-green text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">
                        0
                    </span>
                </a>
            </nav>

            <!-- Botón hamburguesa para móvil -->
            <button id="menu-toggle" class="md:hidden text-dark-green text-2xl focus:outline-none">
                <i class="fa fa-bars"></i>
            </button>
        </div>

        <!-- Menú móvil desplegable -->
        <div id="mobile-menu"
            class="hidden flex-col bg-white shadow-lg absolute top-16 left-0 w-full px-6 py-6 space-y-6 transform transition-all duration-300 ease-in-out">

            <a href="../index.html" class="hover:text-sage-green flex items-center text-lg">
                <i class="fa fa-home mr-2 text-sage-green"></i> Inicio
            </a>

            <a href="productos.html" class="hover:text-sage-green flex items-center text-lg">
                <i class="fa fa-cube mr-2 text-sage-green"></i> Productos
            </a>

            <a href="contacto.html" class="hover:text-sage-green flex items-center text-lg">
                <i class="fa fa-phone mr-2 text-sage-green"></i> Contacto
            </a>

            <!-- Carrito en versión móvil -->
            <a href="carrito.html" class="relative flex items-center text-lg hover:text-sage-green text-sage-green">
                <i class="fa fa-shopping-cart text-xl mr-2 text-sage-green"></i> Carrito
                <span id="cart-count-mobile"
                    class="absolute -top-2 left-20 bg-sage-green text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">
                    0
                </span>
            </a>
        </div>
    </header>

    <!-- Script para funcionalidad del menú móvil -->
    <script>
        /**
         * Funcionalidad del menú hamburguesa
         */
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');

        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            mobileMenu.classList.toggle('opacity-100');
        });
    </script>

    <!-- ========================================
         CONTENIDO PRINCIPAL
         ======================================== -->
    <main class="flex-1 pt-20">
        <!-- Hero del carrito -->
        <section class="bg-gradient-to-r from-dark-green to-sage-green text-white py-16">
            <div class="max-w-6xl mx-auto px-6 text-center">
                <h1 class="font-serif text-4xl md:text-5xl font-bold mb-4">
                    <i class="fas fa-shopping-cart mr-3"></i>
                    Tu Carrito de Compras
                </h1>
                <p class="text-lg md:text-xl opacity-90">
                    Revisa tus productos seleccionados y finaliza tu compra
                </p>
            </div>
        </section>

        <!-- Contenido del carrito -->
        <section class="max-w-6xl mx-auto px-6 py-12">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

                <!-- ========================================
                     LISTA DE PRODUCTOS EN EL CARRITO
                     ======================================== -->
                <div class="lg:col-span-2">
                    <!-- Header de la lista -->
                    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                        <div class="flex items-center justify-between">
                            <h2 class="text-2xl font-bold text-dark-green">
                                <i class="fas fa-list mr-2"></i>
                                Productos en tu carrito
                            </h2>
                            <button id="clear-cart" class="text-red-500 hover:text-red-700 transition">
                                <i class="fas fa-trash mr-1"></i>
                                Vaciar carrito
                            </button>
                        </div>
                        <p class="text-gray-600 mt-2">
                            <span id="cart-items-count">0</span> productos seleccionados
                        </p>
                    </div>

                    <!-- Lista de productos -->
                    <div id="cart-items-container">
                        <!-- Los productos se insertan aquí dinámicamente -->
                    </div>

                    <!-- Mensaje de carrito vacío -->
                    <div id="empty-cart-message" class="bg-white rounded-xl shadow-md p-12 text-center">
                        <i class="fas fa-shopping-cart text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-500 mb-2">Tu carrito está vacío</h3>
                        <p class="text-gray-400 mb-6">¡Agrega algunos productos para comenzar!</p>
                        <a href="productos.html"
                            class="bg-dark-green text-white px-6 py-3 rounded-lg hover:bg-sage-green transition inline-flex items-center">
                            <i class="fas fa-cube mr-2"></i>
                            Ver productos
                        </a>
                    </div>
                </div>

                <!-- ========================================
                     RESUMEN DE COMPRA
                     ======================================== -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-md p-6 sticky top-24">
                        <h3 class="text-xl font-bold text-dark-green mb-6">
                            <i class="fas fa-calculator mr-2"></i>
                            Resumen de compra
                        </h3>

                        <!-- Desglose de precios -->
                        <div class="space-y-4 mb-6">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Subtotal:</span>
                                <span id="subtotal" class="font-semibold">$0.00 MXN</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Envío:</span>
                                <span id="shipping" class="font-semibold">$50.00 MXN</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Descuento:</span>
                                <span id="discount" class="font-semibold text-green-600">-$0.00 MXN</span>
                            </div>
                            <hr class="border-gray-200">
                            <div class="flex justify-between text-lg font-bold">
                                <span>Total:</span>
                                <span id="total" class="text-dark-green">$0.00 MXN</span>
                            </div>
                        </div>

                        <!-- Código de descuento -->
                        <div class="mb-6">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                Código de descuento
                            </label>
                            <div class="flex">
                                <input type="text" id="discount-code" placeholder="Ingresa tu código"
                                    class="flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-dark-green">
                                <button id="apply-discount"
                                    class="bg-dark-green text-white px-4 py-2 rounded-r-lg hover:bg-sage-green transition">
                                    Aplicar
                                </button>
                            </div>
                        </div>

                        <!-- Botones de acción -->
                        <div class="space-y-3">
                            <button id="checkout-btn"
                                class="w-full bg-dark-green text-white py-3 rounded-lg hover:bg-sage-green transition font-semibold">
                                <i class="fas fa-credit-card mr-2"></i>
                                Proceder al pago
                            </button>
                            <a href="productos.html"
                                class="w-full bg-gray-100 text-dark-green py-3 rounded-lg hover:bg-gray-200 transition font-semibold text-center block">
                                <i class="fas fa-arrow-left mr-2"></i>
                                Seguir comprando
                            </a>
                        </div>

                        <!-- Métodos de pago aceptados -->
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <p class="text-sm text-gray-600 mb-3">Métodos de pago aceptados:</p>
                            <div class="flex space-x-2">
                                <i class="fab fa-cc-visa text-2xl text-blue-600"></i>
                                <i class="fab fa-cc-mastercard text-2xl text-red-500"></i>
                                <i class="fab fa-cc-paypal text-2xl text-blue-500"></i>
                                <i class="fas fa-university text-2xl text-gray-600"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ========================================
         FOOTER REDISEÑADO
         ======================================== -->
    <!-- Footer Rediseñado -->
    <footer class="bg-gradient-to-br from-dark-green via-dark-green to-sage-green text-white relative overflow-hidden">
        <!-- Elementos decorativos -->
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-10 left-10 w-32 h-32 bg-white rounded-full blur-3xl"></div>
            <div class="absolute bottom-10 right-10 w-48 h-48 bg-sage-green rounded-full blur-3xl"></div>
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-leaf-green rounded-full blur-3xl"></div>
        </div>

        <div class="relative z-10">
            <!-- Contenido principal del footer -->
            <div class="container mx-auto px-6 py-16">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    
                    <!-- Logo y descripción -->
                    <div class="lg:col-span-2 space-y-6">
                        <div class="flex items-center space-x-3">
                            <img src="../images/logo.png" alt="Velas Starlight" class="h-12 w-auto filter brightness-0 invert">
                            <div>
                                <h3 class="text-2xl font-serif font-bold">Velas Starlight</h3>
                                <p class="text-sage-green/80 text-sm">Artesanía Premium</p>
                            </div>
                        </div>
                        <p class="text-gray-300 leading-relaxed max-w-md">
                            Creamos experiencias sensoriales únicas con velas artesanales y productos de belleza natural, elaborados con amor y dedicación para iluminar tu mundo.
                        </p>
                        
                        <!-- Newsletter -->
                        <div class="space-y-3">
                            <h4 class="font-semibold text-lg">Suscríbete a nuestro newsletter</h4>
                            <div class="flex flex-col sm:flex-row gap-2">
                                <input type="email" placeholder="Tu correo electrónico" 
                                    class="flex-1 px-4 py-2 rounded-lg bg-white/10 border border-white/20 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-sage-green focus:border-transparent">
                                <button class="bg-sage-green hover:bg-sage-green/80 px-6 py-2 rounded-lg font-semibold transition-colors duration-300">
                                    Suscribirse
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Enlaces rápidos -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold mb-4 text-white">Enlaces Rápidos</h4>
                        <ul class="space-y-3">
                            <li><a href="../index.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                <i class="fa fa-home mr-2 group-hover:scale-110 transition-transform duration-300"></i>Inicio
                            </a></li>
                            <li><a href="productos.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                <i class="fa fa-cube mr-2 group-hover:scale-110 transition-transform duration-300"></i>Productos
                            </a></li>
                            <li><a href="blog.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                <i class="fa fa-blog mr-2 group-hover:scale-110 transition-transform duration-300"></i>Blog
                            </a></li>
                            <li><a href="contacto.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                <i class="fa fa-phone mr-2 group-hover:scale-110 transition-transform duration-300"></i>Contacto
                            </a></li>
                            <li><a href="politicas.html" class="text-gray-300 hover:text-white transition-colors duration-300 flex items-center group">
                                <i class="fa fa-shield-alt mr-2 group-hover:scale-110 transition-transform duration-300"></i>Políticas
                            </a></li>
                        </ul>
                    </div>

                    <!-- Contacto y redes sociales -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold mb-4 text-white">Conecta con Nosotros</h4>
                        
                        <!-- Información de contacto -->
                        <div class="space-y-3 text-gray-300">
                            <div class="flex items-center space-x-3">
                                <i class="fa fa-envelope text-white"></i>
                                <span>ventas@velasstarlight.com</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <i class="fa fa-phone text-white"></i>
                                <span>5564682112</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <i class="fa fa-map-marker-alt text-white"></i>
                                <span>123 Artisan Street, Ciudad</span>
                            </div>
                        </div>

                        <!-- Redes sociales -->
                        <div class="pt-4">
                            <h5 class="font-medium mb-3">Síguenos</h5>
                            <div class="flex space-x-4">
                                <a href="https://wa.me/5564682112" target="_blank" 
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-whatsapp text-lg group-hover:text-white"></i>
                                </a>
                                <a href="https://www.instagram.com/velas_starlight/" target="_blank" 
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-instagram text-lg group-hover:text-white"></i>
                                </a>
                                <a href="#" target="_blank" 
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-facebook-f text-lg group-hover:text-white"></i>
                                </a>
                                <a href="#" target="_blank" 
                                    class="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center hover:bg-sage-green hover:scale-110 transition-all duration-300 group">
                                    <i class="fab fa-tiktok text-lg group-hover:text-white"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Línea divisoria -->
            <div class="border-t border-white/20"></div>

            <!-- Copyright y enlaces legales -->
            <div class="container mx-auto px-6 py-6">
                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                    <div class="text-gray-300 text-sm">
                        <p>&copy; 2025 Velas Starlight. Todos los derechos reservados.</p>
                    </div>
                    <div class="flex items-center space-x-6 text-sm text-gray-300">
                        <a href="politicas.html" class="hover:text-white transition-colors duration-300">Términos y Condiciones</a>
                        <span class="text-gray-500">|</span>
                        <a href="politicas.html" class="hover:text-white transition-colors duration-300">Política de Privacidad</a>
                        <span class="text-gray-500">|</span>
                        <span class="flex items-center space-x-1">
                            <i class="fa fa-heart text-red-400"></i>
                            <span>Hecho con amor</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- ========================================
         JAVASCRIPT - SISTEMA DE CARRITO
         ======================================== -->
    <script>
        /**
         * Clase para manejar el carrito de compras
         */
        class ShoppingCart {
            constructor() {
                this.items = this.loadCart();
                this.shippingCost = 50;
                this.discountAmount = 0;
                this.discountCodes = {
                    'BIENVENIDO': 10, // 10% de descuento
                    'PRIMERA': 15,    // 15% de descuento
                    'STARLIGHT': 20   // 20% de descuento
                };
                this.init();
            }

            /**
             * Inicializar el carrito
             */
            init() {
                this.updateCartDisplay();
                this.updateCartCount();
                this.setupEventListeners();
                console.log('🛒 Carrito inicializado con', this.items.length, 'productos');
            }

            /**
             * Cargar carrito desde localStorage
             */
            loadCart() {
                try {
                    const saved = localStorage.getItem('starlight_cart');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.error('Error cargando carrito:', error);
                    return [];
                }
            }

            /**
             * Guardar carrito en localStorage
             */
            saveCart() {
                try {
                    localStorage.setItem('starlight_cart', JSON.stringify(this.items));
                    console.log('💾 Carrito guardado');
                } catch (error) {
                    console.error('Error guardando carrito:', error);
                }
            }

            /**
             * Actualizar contador del carrito en el header
             */
            updateCartCount() {
                const totalItems = this.items.reduce((sum, item) => sum + item.quantity, 0);
                const countElements = document.querySelectorAll('#cart-count, #cart-count-mobile');
                countElements.forEach(el => {
                    if (el) el.textContent = totalItems;
                });
            }

            /**
             * Actualizar visualización del carrito
             */
            updateCartDisplay() {
                const container = document.getElementById('cart-items-container');
                const emptyMessage = document.getElementById('empty-cart-message');
                const itemsCount = document.getElementById('cart-items-count');

                if (this.items.length === 0) {
                    container.style.display = 'none';
                    emptyMessage.style.display = 'block';
                    itemsCount.textContent = '0';
                } else {
                    container.style.display = 'block';
                    emptyMessage.style.display = 'none';
                    itemsCount.textContent = this.items.length;
                    this.renderCartItems();
                }

                this.updateTotals();
            }

            /**
             * Renderizar productos en el carrito
             */
            renderCartItems() {
                const container = document.getElementById('cart-items-container');
                container.innerHTML = '';

                this.items.forEach((item, index) => {
                    const itemElement = this.createCartItemElement(item, index);
                    container.appendChild(itemElement);
                });
            }

            /**
             * Crear elemento HTML para un producto del carrito
             */
            createCartItemElement(item, index) {
                const div = document.createElement('div');
                div.className = 'cart-item bg-white rounded-xl shadow-md p-6 mb-4';

                div.innerHTML = `
                    <div class="flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-6">
                        <!-- Imagen del producto -->
                        <div class="flex-shrink-0">
                            <img src="${item.image}" alt="${item.title}" 
                                 class="w-20 h-20 md:w-24 md:h-24 object-cover rounded-lg border-2 border-gray-100">
                        </div>

                        <!-- Información del producto -->
                        <div class="flex-grow">
                            <h3 class="font-bold text-lg text-dark-green mb-2">${item.title}</h3>
                            <div class="space-y-1 text-sm text-gray-600">
                                <p><span class="font-semibold">Tipo:</span> ${item.type}</p>
                                <p><span class="font-semibold">Tamaño:</span> ${item.size}</p>
                                <p><span class="font-semibold">Fragancia:</span> ${item.fragrance}</p>
                                <p><span class="font-semibold">Precio unitario:</span> $${(item.price || 0).toFixed(2)} MXN</p>
                            </div>
                        </div>

                        <!-- Controles de cantidad y precio -->
                        <div class="flex flex-col items-end space-y-3">
                            <!-- Control de cantidad -->
                            <div class="flex items-center space-x-2">
                                <button onclick="cart.updateQuantity(${index}, ${item.quantity - 1})" 
                                        class="quantity-btn bg-gray-200 hover:bg-gray-300 text-dark-green w-8 h-8 rounded-full flex items-center justify-center">
                                    <i class="fas fa-minus text-xs"></i>
                                </button>
                                <span class="w-12 text-center font-semibold">${item.quantity}</span>
                                <button onclick="cart.updateQuantity(${index}, ${item.quantity + 1})" 
                                        class="quantity-btn bg-gray-200 hover:bg-gray-300 text-dark-green w-8 h-8 rounded-full flex items-center justify-center">
                                    <i class="fas fa-plus text-xs"></i>
                                </button>
                            </div>

                            <!-- Precio total del producto -->
                            <div class="text-right">
                                <p class="text-lg font-bold text-dark-green">$${((item.price || 0) * item.quantity).toFixed(2)} MXN</p>
                            </div>

                            <!-- Botón eliminar -->
                            <button onclick="cart.removeItem(${index})" 
                                    class="text-red-500 hover:text-red-700 transition text-sm">
                                <i class="fas fa-trash mr-1"></i>
                                Eliminar
                            </button>
                        </div>
                    </div>
                `;

                return div;
            }

            /**
             * Actualizar cantidad de un producto
             */
            updateQuantity(index, newQuantity) {
                if (newQuantity <= 0) {
                    this.removeItem(index);
                } else {
                    this.items[index].quantity = newQuantity;
                    this.saveCart();
                    this.updateCartDisplay();
                    this.updateCartCount();
                }
            }

            /**
             * Eliminar producto del carrito
             */
            removeItem(index) {
                this.items.splice(index, 1);
                this.saveCart();
                this.updateCartDisplay();
                this.updateCartCount();

                // Mostrar notificación
                this.showNotification('Producto eliminado del carrito', 'info');
            }

            /**
             * Vaciar carrito completamente
             */
            clearCart() {
                if (confirm('¿Estás seguro de que quieres vaciar el carrito?')) {
                    this.items = [];
                    this.saveCart();
                    this.updateCartDisplay();
                    this.updateCartCount();
                    this.showNotification('Carrito vaciado', 'info');
                }
            }

            /**
             * Calcular subtotal
             */
            getSubtotal() {
                return this.items.reduce((sum, item) => sum + ((item.price || 0) * item.quantity), 0);
            }

            /**
             * Aplicar código de descuento
             */
            applyDiscount(code) {
                const upperCode = code.toUpperCase();
                if (this.discountCodes[upperCode]) {
                    const percentage = this.discountCodes[upperCode];
                    const subtotal = this.getSubtotal();
                    this.discountAmount = (subtotal * percentage) / 100;
                    this.updateTotals();
                    this.showNotification(`¡Descuento del ${percentage}% aplicado!`, 'success');
                    return true;
                } else {
                    this.showNotification('Código de descuento inválido', 'error');
                    return false;
                }
            }

            /**
             * Actualizar totales en el resumen
             */
            updateTotals() {
                const subtotal = this.getSubtotal();
                const shipping = this.items.length > 0 ? this.shippingCost : 0;
                const total = subtotal + shipping - this.discountAmount;

                document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)} MXN`;
                document.getElementById('shipping').textContent = `$${shipping.toFixed(2)} MXN`;
                document.getElementById('discount').textContent = `-$${this.discountAmount.toFixed(2)} MXN`;
                document.getElementById('total').textContent = `$${total.toFixed(2)} MXN`;
            }

            /**
             * Configurar event listeners
             */
            setupEventListeners() {
                // Vaciar carrito
                document.getElementById('clear-cart').addEventListener('click', () => {
                    this.clearCart();
                });

                // Aplicar descuento
                document.getElementById('apply-discount').addEventListener('click', () => {
                    const code = document.getElementById('discount-code').value.trim();
                    if (code) {
                        this.applyDiscount(code);
                        document.getElementById('discount-code').value = '';
                    }
                });

                // Proceder al pago
                document.getElementById('checkout-btn').addEventListener('click', () => {
                    this.checkout();
                });
            }

            /**
             * Procesar checkout
             */
            checkout() {
                if (this.items.length === 0) {
                    this.showNotification('Tu carrito está vacío', 'error');
                    return;
                }

                // Aquí puedes integrar con un sistema de pago real
                const total = this.getSubtotal() + this.shippingCost - this.discountAmount;

                if (confirm(`¿Proceder al pago por $${total.toFixed(2)} MXN?`)) {
                    // Simular proceso de pago
                    this.showNotification('Redirigiendo al sistema de pago...', 'info');

                    // En una implementación real, aquí rediriges a la pasarela de pago
                    setTimeout(() => {
                        alert('¡Gracias por tu compra! (Esta es una simulación)');
                        this.items = [];
                        this.saveCart();
                        this.updateCartDisplay();
                        this.updateCartCount();
                    }, 2000);
                }
            }

            /**
             * Mostrar notificación
             */
            showNotification(message, type = 'info') {
                // Crear elemento de notificación
                const notification = document.createElement('div');
                notification.className = `fixed top-24 right-6 z-50 px-6 py-3 rounded-lg shadow-lg text-white transform transition-all duration-300 translate-x-full`;

                // Colores según el tipo
                switch (type) {
                    case 'success':
                        notification.classList.add('bg-green-500');
                        break;
                    case 'error':
                        notification.classList.add('bg-red-500');
                        break;
                    default:
                        notification.classList.add('bg-blue-500');
                }

                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info-circle'}"></i>
                        <span>${message}</span>
                    </div>
                `;

                document.body.appendChild(notification);

                // Animar entrada
                setTimeout(() => {
                    notification.classList.remove('translate-x-full');
                }, 100);

                // Remover después de 3 segundos
                setTimeout(() => {
                    notification.classList.add('translate-x-full');
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 3000);
            }
        }

        /**
         * Inicializar carrito cuando el DOM esté listo
         */
        let cart;
        document.addEventListener('DOMContentLoaded', function () {
            console.log('🚀 Inicializando página de carrito');
            cart = new ShoppingCart();
            
            // Debug: Función para inspeccionar carrito
            window.debugCart = function() {
                console.log('🔍 Debug del carrito:');
                console.log('📦 Productos:', cart.items);
                console.log('💰 Subtotal:', cart.getSubtotal());
                console.log('🔢 Total items:', cart.items.reduce((sum, item) => sum + item.quantity, 0));
                
                cart.items.forEach((item, index) => {
                    console.log(`Producto ${index + 1}:`, {
                        title: item.title,
                        price: item.price,
                        quantity: item.quantity,
                        total: (item.price || 0) * item.quantity
                    });
                });
            };
        });
    </script>

</body>

</html>